component: font_system_api
version: 0.1.0
language: rust
description: Public API and orchestration for complete font system

dependencies:
  - font_types
  - font_parser
  - font_registry
  - text_shaper
  - glyph_renderer
  - platform_integration

public_api:
  structs:
    - name: FontSystem
      description: Main font system interface
      methods:
        - name: new
          description: Create new font system with configuration
          parameters:
            - name: config
              type: FontSystemConfig
          returns: Result<FontSystem, FontError>

        - name: load_system_fonts
          description: Load all system fonts
          returns: Result<usize, FontError>
          description_detail: Returns count of fonts loaded

        - name: load_font_file
          description: Load font from file
          parameters:
            - name: path
              type: "&Path"
          returns: Result<FontId, FontError>

        - name: load_font_data
          description: Load font from memory
          parameters:
            - name: data
              type: Vec<u8>
          returns: Result<FontId, FontError>

        - name: match_font
          description: Find best matching font
          parameters:
            - name: descriptor
              type: "&FontDescriptor"
          returns: Option<FontId>

        - name: shape_text
          description: Shape text with specific font
          parameters:
            - name: text
              type: "&str"
            - name: font_id
              type: FontId
            - name: size
              type: f32
            - name: options
              type: "&ShapingOptions"
          returns: Result<ShapedText, FontError>

        - name: shape_text_with_fallback
          description: Shape text with font fallback
          parameters:
            - name: text
              type: "&str"
            - name: descriptor
              type: "&FontDescriptor"
            - name: options
              type: "&ShapingOptions"
          returns: Result<ShapedText, FontError>

        - name: rasterize_glyph
          description: Rasterize glyph to bitmap
          parameters:
            - name: font_id
              type: FontId
            - name: glyph_id
              type: GlyphId
            - name: size
              type: f32
            - name: mode
              type: RenderMode
          returns: Result<GlyphBitmap, FontError>

        - name: get_font_metrics
          description: Get font metrics
          parameters:
            - name: font_id
              type: FontId
            - name: size
              type: f32
          returns: Option<FontMetrics>

        - name: get_glyph_outline
          description: Get glyph vector outline
          parameters:
            - name: font_id
              type: FontId
            - name: glyph_id
              type: GlyphId
          returns: Result<GlyphOutline, FontError>

        - name: font_count
          description: Get number of loaded fonts
          returns: usize

        - name: clear_caches
          description: Clear all caches
          returns: ()

    - name: FontSystemConfig
      description: Font system configuration
      fields:
        - name: cache_size_mb
          type: usize
          description: Maximum cache size in MB
        - name: enable_subpixel
          type: bool
          description: Enable subpixel rendering
        - name: enable_hinting
          type: bool
          description: Enable TrueType hinting
        - name: load_system_fonts_on_init
          type: bool
          description: Load system fonts during initialization

  enums:
    - name: FontError
      description: Font system errors
      variants:
        - FontNotFound
        - InvalidFont: String
        - LoadError: String
        - ShapingError: String
        - RenderError: String
        - SystemError: String

exports:
  - FontSystem
  - FontSystemConfig
  - FontError
